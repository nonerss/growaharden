--[[ 
üçé Fruit ESP (with Name, Weight, Price)
üéÆ ESP toggle via button in GUI
üîë Press G to show/hide GUI
]]

-- Services
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Cleanup previous
pcall(function() LocalPlayer.PlayerGui:FindFirstChild("FruitESP_UI"):Destroy() end)
pcall(function() game.CoreGui:FindFirstChild("FruitESP_Folder"):Destroy() end)

-- GUI Setup
local gui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
gui.Name = "FruitESP_UI"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 300, 0, 130)
frame.Position = UDim2.new(0.5, -150, 0.05, 0)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, 0, 0, 30)
title.Text = "üçé Fruit ESP GUI"
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.new(1,1,1)
title.TextSize = 18

local status = Instance.new("TextLabel", frame)
status.Position = UDim2.new(0, 0, 0, 35)
status.Size = UDim2.new(1, 0, 0, 40)
status.Text = "ESP is currently: üî¥ OFF"
status.Font = Enum.Font.Gotham
status.TextColor3 = Color3.fromRGB(255, 150, 150)
status.BackgroundTransparency = 1
status.TextSize = 14
status.TextWrapped = true

local toggleBtn = Instance.new("TextButton", frame)
toggleBtn.Size = UDim2.new(1, -20, 0, 40)
toggleBtn.Position = UDim2.new(0, 10, 1, -45)
toggleBtn.BackgroundColor3 = Color3.fromRGB(50,150,50)
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 16
toggleBtn.Text = "‚úÖ Enable Fruit ESP"

-- Toggle GUI with G
UIS.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.G then
        gui.Enabled = not gui.Enabled
    end
end)

-- ESP Folder
local espFolder = Instance.new("Folder", game.CoreGui)
espFolder.Name = "FruitESP_Folder"

-- ESP Helpers
local function getAttributeOrChildValue(obj, key)
    if obj:GetAttribute(key) then return obj:GetAttribute(key) end
    local child = obj:FindFirstChild(key)
    if child and (child:IsA("NumberValue") or child:IsA("StringValue")) then
        return child.Value
    end
    return nil
end

local function createESP(part)
    local id = "FruitESP_" .. part:GetDebugId()
    if espFolder:FindFirstChild(id) then return end

    local name = part.Name
    local weight = getAttributeOrChildValue(part, "Weight") or "?"
    local price = getAttributeOrChildValue(part, "Price") or "?"

    local billboard = Instance.new("BillboardGui", espFolder)
    billboard.Name = id
    billboard.Adornee = part
    billboard.Size = UDim2.new(0, 150, 0, 60)
    billboard.AlwaysOnTop = true

    local label = Instance.new("TextLabel", billboard)
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 100)
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextWrapped = true
    label.Text = string.format("üçé %s\n‚öñÔ∏è Weight: %s\nüí∞ Price: %s", name, tostring(weight), tostring(price))
end

-- ESP Toggle Logic
local espEnabled = false

local function clearESP()
    for _, v in pairs(espFolder:GetChildren()) do
        v:Destroy()
    end
end

local function scanForFruits()
    if not espEnabled then return end
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and obj.Name:lower():match("fruit") then
            createESP(obj)
        end
    end
end

-- Toggle Button
toggleBtn.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    if espEnabled then
        toggleBtn.Text = "‚ùå Disable Fruit ESP"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        status.Text = "ESP is currently: üü¢ ON"
        status.TextColor3 = Color3.fromRGB(150, 255, 150)
        scanForFruits()
    else
        toggleBtn.Text = "‚úÖ Enable Fruit ESP"
        toggleBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
        status.Text = "ESP is currently: üî¥ OFF"
        status.TextColor3 = Color3.fromRGB(255, 150, 150)
        clearESP()
    end
end)

-- Loop ESP scan every 5 seconds
task.spawn(function()
    while true do
        if espEnabled then
            pcall(scanForFruits)
        end
        task.wait(5)
    end
end)
